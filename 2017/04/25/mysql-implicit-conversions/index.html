<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>mysql隐式转换 | 时秋的博客 | Talk is cheap , show your code .</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="mysql">
    <meta name="description" content="前言在使用mysql过程中，可能经常遇到两类问题：

这个字段明明有索引，但是查询依然很慢，执行计划竟然不走索引？？？
这个sql看起来没什么问题，为什么就是没有拿到预期的数据？mysql出bug了？

这时候不妨停下来思考一下，是不是查询条件的数据类型和表字段类型不匹配，mysql执行时发生了隐式转换，可以通过 show warnings; 看看是否有警告。
转换潜规则先去官方文档看看隐式转换的">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql隐式转换">
<meta property="og:url" content="https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/index.html">
<meta property="og:site_name" content="时秋的博客">
<meta property="og:description" content="前言在使用mysql过程中，可能经常遇到两类问题：

这个字段明明有索引，但是查询依然很慢，执行计划竟然不走索引？？？
这个sql看起来没什么问题，为什么就是没有拿到预期的数据？mysql出bug了？

这时候不妨停下来思考一下，是不是查询条件的数据类型和表字段类型不匹配，mysql执行时发生了隐式转换，可以通过 show warnings; 看看是否有警告。
转换潜规则先去官方文档看看隐式转换的">
<meta property="og:updated_time" content="2017-04-25T10:57:10.406Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mysql隐式转换">
<meta name="twitter:description" content="前言在使用mysql过程中，可能经常遇到两类问题：

这个字段明明有索引，但是查询依然很慢，执行计划竟然不走索引？？？
这个sql看起来没什么问题，为什么就是没有拿到预期的数据？mysql出bug了？

这时候不妨停下来思考一下，是不是查询条件的数据类型和表字段类型不匹配，mysql执行时发生了隐式转换，可以通过 show warnings; 看看是否有警告。
转换潜规则先去官方文档看看隐式转换的">
    
        <link rel="alternative" href="/atom.xml" title="时秋的博客" type="application/atom+xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.5.0">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">时秋</h5>
          <a href="mailto:shiqiu-beta@qq.com" title="shiqiu-beta@qq.com" class="mail">shiqiu-beta@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                列表
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                分类
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/shiqiupp" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/weibo" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                围脖
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/aboutme"  >
                <i class="icon icon-lg icon-link"></i>
                关于我
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">mysql隐式转换</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
        <span>
            <a href="/atom.xml" target="_blank" class="header-icon waves-effect waves-circle waves-light" title="rss">
                <i class="icon icon-lg icon-rss"></i>
            </a>
        </span>
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale" style="    padding-top: 10px;">
        <h1 class="title">mysql隐式转换</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-04-25T08:58:05.000Z" itemprop="datePublished" class="page-time">
  2017-04-25
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/mysql/">mysql</a></li></ul>

            
        </h5>
    </div>

    

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#转换潜规则"><span class="post-toc-number">2.</span> <span class="post-toc-text">转换潜规则</span></a></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#实战的坑"><span class="post-toc-number">3.</span> <span class="post-toc-text">实战的坑</span></a></li></ol>
        </nav>
    </aside>
    
<article id="post-mysql-implicit-conversions"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">mysql隐式转换</h1>
        <div class="post-meta">
            <time class="post-time" title="2017年04月25日 16:58" datetime="2017-04-25T08:58:05.000Z"  itemprop="datePublished">2017-04-25</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/mysql/">mysql</a></li></ul>



            

            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在使用mysql过程中，可能经常遇到两类问题：</p>
<ul>
<li>这个字段明明有索引，但是查询依然很慢，执行计划竟然不走索引？？？</li>
<li>这个sql看起来没什么问题，为什么就是没有拿到预期的数据？mysql出bug了？</li>
</ul>
<p>这时候不妨停下来思考一下，是不是查询条件的数据类型和表字段类型不匹配，mysql执行时发生了隐式转换，可以通过 show warnings; 看看是否有警告。</p>
<h1 id="转换潜规则"><a href="#转换潜规则" class="headerlink" title="转换潜规则"></a>转换潜规则</h1><p>先去官方文档看看隐式转换的潜规则：<a href="https://dev.mysql.com/doc/refman/5.7/en/type-conversion.html" target="_blank" rel="external">官方文档</a><br>摘取片段：</p>
<blockquote>
<p>The following rules describe how conversion occurs for comparison operations:</p>
<ul>
<li>If one or both arguments are NULL, the result of the comparison is NULL, except for the NULL-safe &lt;=&gt; equality comparison operator. For NULL &lt;=&gt; NULL, the result is true. No conversion is needed.</li>
<li>If both arguments in a comparison operation are strings, they are compared as strings.</li>
<li>If both arguments are integers, they are compared as integers.</li>
<li>Hexadecimal values are treated as binary strings if not compared to a number.</li>
<li>If one of the arguments is a TIMESTAMP or DATETIME column and the other argument is a constant, the constant is converted to a timestamp before the comparison is performed. This is done to be more ODBC-friendly. Note that this is not done for the arguments to IN()! To be safe, always use complete datetime, date, or time strings when doing comparisons. For example, to achieve best results when using BETWEEN with date or time values, use CAST() to explicitly convert the values to the desired data type.</li>
<li>A single-row subquery from a table or tables is not considered a constant. For example, if a subquery returns an integer to be compared to a DATETIME value, the comparison is done as two integers. The integer is not converted to a temporal value. To compare the operands as DATETIME values, use CAST() to explicitly convert the subquery value to DATETIME.</li>
<li>If one of the arguments is a decimal value, comparison depends on the other argument. The arguments are compared as decimal values if the other argument is a decimal or integer value, or as floating-point values if the other argument is a floating-point value.</li>
<li>In all other cases, the arguments are compared as floating-point (real) numbers.</li>
</ul>
</blockquote>
<p>翻译过来就是：</p>
<blockquote>
<ul>
<li>两个参数至少有一个是 NULL 时，比较的结果也是 NULL，例外是使用 &lt;=&gt; 对两个 NULL 做比较时会返回 1，这两种情况都不需要做类型转换;</li>
<li>两个参数都是字符串，会按照字符串来比较，不做类型转换;</li>
<li>两个参数都是整数，按照整数来比较，不做类型转换;</li>
<li>十六进制的值和非数字做比较时，会被当做二进制串;</li>
<li>有一个参数是 TIMESTAMP 或 DATETIME，并且另外一个参数是常量，常量会被转换为 timestamp;</li>
<li>有一个参数是 decimal 类型，如果另外一个参数是 decimal 或者整数，会将整数转换为 decimal 后进行比较，如果另外一个参数是浮点数，则会把 decimal 转换为浮点数进行比较;</li>
<li>所有其他情况下，两个参数都会被转换为浮点数再进行比较;</li>
</ul>
</blockquote>
<h1 id="实战的坑"><a href="#实战的坑" class="headerlink" title="实战的坑"></a>实战的坑</h1><p>先建一个表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">CREATE TABLE `scores` (</div><div class="line">  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT &apos;id&apos;,</div><div class="line">  `name` varchar(20) COLLATE utf8_bin DEFAULT NULL COMMENT &apos;姓名&apos;,</div><div class="line">  `course` varchar(20) COLLATE utf8_bin DEFAULT NULL COMMENT &apos;课程&apos;,</div><div class="line">  `score` int(11) DEFAULT &apos;0&apos; COMMENT &apos;分数&apos;,</div><div class="line">  PRIMARY KEY (`id`),</div><div class="line">  KEY `idx_name_course` (`name`,`course`),</div><div class="line">  KEY `idx_course` (`course`),</div><div class="line">  KEY `idx_score` (`score`)</div><div class="line">) ENGINE=InnoDB   DEFAULT CHARSET=utf8 COLLATE=utf8_bin</div></pre></td></tr></table></figure></p>
<p>表中数据如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select * from  `scores`;</div><div class="line">+----+--------+--------+-------+</div><div class="line">| id | name   | course | score |</div><div class="line">+----+--------+--------+-------+</div><div class="line">|  1 | 张三   | 语文   |    89 |</div><div class="line">|  2 | 张三   | 数学   |    79 |</div><div class="line">|  3 | 张三   | 英语   |    96 |</div><div class="line">|  4 | 李四   | 语文   |    90 |</div><div class="line">|  5 | 李四   | 数学   |    85 |</div><div class="line">|  6 | 李四   | 英语   |    94 |</div><div class="line">|  7 | 王五   | 语文   |    87 |</div><div class="line">|  8 | 王五   | 英语   |    94 |</div><div class="line">|  9 | 11aaa  | 语文   |   100 |</div><div class="line">| 10 | 11bbb | 数学   |    89 |</div><div class="line">+----+--------+--------+-------+</div><div class="line">10 rows in set (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>注意varchar和int之间的参数转换：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select * from  `scores` where name = 0;</div><div class="line">+----+--------+--------+-------+</div><div class="line">| id | name   | course | score |</div><div class="line">+----+--------+--------+-------+</div><div class="line">|  1 | 张三   | 语文   |    89 |</div><div class="line">|  2 | 张三   | 数学   |    79 |</div><div class="line">|  3 | 张三   | 英语   |    96 |</div><div class="line">|  4 | 李四   | 语文   |    90 |</div><div class="line">|  5 | 李四   | 数学   |    85 |</div><div class="line">|  6 | 李四   | 英语   |    94 |</div><div class="line">|  7 | 王五   | 语文   |    87 |</div><div class="line">|  8 | 王五   | 英语   |    94 |</div><div class="line">+----+--------+--------+-------+</div><div class="line">8 rows in set, 10 warnings (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; show warnings;</div><div class="line">+---------+------+--------------------------------------------+</div><div class="line">| Level   | Code | Message                                    |</div><div class="line">+---------+------+--------------------------------------------+</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;张三&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;张三&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;张三&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;李四&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;李四&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;李四&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;王五&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;王五&apos;   |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;11aaa&apos;  |</div><div class="line">| Warning | 1292 | Truncated incorrect DOUBLE value: &apos;11bbb&apos; |</div><div class="line">+---------+------+--------------------------------------------+</div><div class="line">10 rows in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from  `scores` where name = 11;</div><div class="line">+----+-------+--------+-------+</div><div class="line">| id | name  | course | score |</div><div class="line">+----+-------+--------+-------+</div><div class="line">|  9 | 11aaa | 语文   |   100 |</div><div class="line">| 10 | 11bbb | 数学   |    89 |</div><div class="line">+----+-------+--------+-------+</div><div class="line">2 rows in set, 10 warnings (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from  `scores` where name = 11 + &apos;aaa&apos;;</div><div class="line">+----+-------+--------+-------+</div><div class="line">| id | name  | course | score |</div><div class="line">+----+-------+--------+-------+</div><div class="line">|  9 | 11aaa | 语文   |   100 |</div><div class="line">| 10 | 11bbb | 数学   |    89 |</div><div class="line">+----+-------+--------+-------+</div><div class="line">2 rows in set, 11 warnings (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from  `scores` where name = &apos;11&apos; + &apos;aaa&apos;;</div><div class="line">+----+-------+--------+-------+</div><div class="line">| id | name  | course | score |</div><div class="line">+----+-------+--------+-------+</div><div class="line">|  9 | 11aaa | 语文   |   100 |</div><div class="line">| 10 | 11bbb | 数学   |    89 |</div><div class="line">+----+-------+--------+-------+</div><div class="line">2 rows in set, 11 warnings (0.00 sec)</div></pre></td></tr></table></figure></p>
<blockquote>
<p>此时已经发生隐式转换了；满足上述最后一条，name字段和int比较，name字段转换成浮点数，转换后再去比较。</p>
</blockquote>
<p>但是上面的转换结果很令人匪夷所思啊？？？下面再来看栗子：</p>
<p>1.字符串转换的潜规则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select &apos;张三&apos; + 1;</div><div class="line">+--------------+</div><div class="line">| &apos;张三&apos; + 1   |</div><div class="line">+--------------+</div><div class="line">|            1 |</div><div class="line">+--------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>根据官方文档：</p>
<blockquote>
<p>When an operator is used with operands of different types, type conversion occurs to make the operands compatible.<br>当一个操作符对应不同类型，那么类型转换主要为了使操作符兼容，并且按照之前隐式转换规则来，所以上述sql中字符串被转成浮点数进行求和，’张三’被转成0；</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select &apos;1sss&apos; + 1;</div><div class="line">+------------+</div><div class="line">| &apos;1sss&apos; + 1 |</div><div class="line">+------------+</div><div class="line">|          2 |</div><div class="line">+------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;sss1&apos; + 1;</div><div class="line">+------------+</div><div class="line">| &apos;sss1&apos; + 1 |</div><div class="line">+------------+</div><div class="line">|          1 |</div><div class="line">+------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;sss1&apos; + &apos;1&apos;;</div><div class="line">+--------------+</div><div class="line">| &apos;sss1&apos; + &apos;1&apos; |</div><div class="line">+--------------+</div><div class="line">|            1 |</div><div class="line">+--------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;1sss&apos; + &apos;1&apos;;</div><div class="line">+--------------+</div><div class="line">| &apos;1sss&apos; + &apos;1&apos; |</div><div class="line">+--------------+</div><div class="line">|            2 |</div><div class="line">+--------------+</div><div class="line">1 row in set, 1 warning (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;1sss&apos; + &apos;sss1&apos;;</div><div class="line">+-----------------+</div><div class="line">| &apos;1sss&apos; + &apos;sss1&apos; |</div><div class="line">+-----------------+</div><div class="line">|               1 |</div><div class="line">+-----------------+</div><div class="line">1 row in set, 2 warnings (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;1sss&apos; + &apos;1sss&apos;;</div><div class="line">+-----------------+</div><div class="line">| &apos;1sss&apos; + &apos;1sss&apos; |</div><div class="line">+-----------------+</div><div class="line">|               2 |</div><div class="line">+-----------------+</div><div class="line">1 row in set, 2 warnings (0.00 sec)</div></pre></td></tr></table></figure>
<blockquote>
<p>If any of the operands of a +, -, /, *, % is a real or string value, the precision of the result is the precision of the operand with the maximum precision.</p>
</blockquote>
<p>看完上述几个例子，相信读者已经有一些感觉了；</p>
<blockquote>
<p>对于 +, -, /, *, % 面对的操作数主要为浮点数，对于字符串会进行隐式转换；更多信息见 <a href="https://dev.mysql.com/doc/refman/5.7/en/arithmetic-functions.html" target="_blank" rel="external">官方文档</a></p>
</blockquote>
<p>2.条件查询字符串和数字类型参数的比较：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select &apos;1sss&apos; = 0;           </div><div class="line">+------------+                      </div><div class="line">| &apos;1sss&apos; = 0 |                      </div><div class="line">+------------+                      </div><div class="line">|          0 |                      </div><div class="line">+------------+                      </div><div class="line">1 row in set, 1 warning (0.00 sec)  </div><div class="line">                                    </div><div class="line">mysql&gt; select &apos;1sss&apos; = 1;           </div><div class="line">+------------+                      </div><div class="line">| &apos;1sss&apos; = 1 |                      </div><div class="line">+------------+                      </div><div class="line">|          1 |                      </div><div class="line">+------------+                      </div><div class="line">1 row in set, 1 warning (0.00 sec)  </div><div class="line">                                    </div><div class="line">mysql&gt; select &apos;sss1&apos; = 0;           </div><div class="line">+------------+                      </div><div class="line">| &apos;sss1&apos; = 0 |                      </div><div class="line">+------------+                      </div><div class="line">|          1 |                      </div><div class="line">+------------+                      </div><div class="line">1 row in set, 1 warning (0.00 sec)  </div><div class="line">                                    </div><div class="line">mysql&gt; select &apos;sss1&apos; = 1;           </div><div class="line">+------------+                      </div><div class="line">| &apos;sss1&apos; = 1 |                      </div><div class="line">+------------+                      </div><div class="line">|          0 |                      </div><div class="line">+------------+                      </div><div class="line">1 row in set, 1 warning (0.00 sec)</div></pre></td></tr></table></figure></p>
<p>从上面的例子可以看出，当把字符串转为数字的时候，其实是从最左边开始处理的：</p>
<ul>
<li>如果字符串的第一个字符就是非数字的字符，那么转换为数字就是0；</li>
<li>如果字符串中都是数字，那么转换为数字就是整个字符串对应的数字；</li>
<li>如果字符串中存在非数字，那么转换为的数字就是开头的那些数字对应的值；</li>
</ul>
<p>3.浮点数转换要注意最大值和精度丢失问题：</p>
<blockquote>
<p>Comparisons that use floating-point numbers (or values that are converted to floating-point numbers) are approximate because such numbers are inexact. This might lead to results that appear inconsistent;<br>Such results can occur because the values are converted to floating-point numbers, which have only 53 bits of precision and are subject to rounding;</p>
</blockquote>
<p>在进行浮点数转换时，可能用科学计数法表示，然后再进行比较，由于精度丢失，导致不正确的结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select &apos;9223372036854775807&apos; = 9223372036854775807;</div><div class="line">+---------------------------------------------+</div><div class="line">| &apos;9223372036854775807&apos; = 9223372036854775807 |</div><div class="line">+---------------------------------------------+</div><div class="line">|                                           1 |</div><div class="line">+---------------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;9223372036854775807&apos; = 9223372036854775808;</div><div class="line">+---------------------------------------------+</div><div class="line">| &apos;9223372036854775807&apos; = 9223372036854775808 |</div><div class="line">+---------------------------------------------+</div><div class="line">|                                           1 |</div><div class="line">+---------------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;9223372036854775808&apos; = 9223372036854775808;</div><div class="line">+---------------------------------------------+</div><div class="line">| &apos;9223372036854775808&apos; = 9223372036854775808 |</div><div class="line">+---------------------------------------------+</div><div class="line">|                                           1 |</div><div class="line">+---------------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;9223372036854775808&apos; = 9223372036854775807;</div><div class="line">+---------------------------------------------+</div><div class="line">| &apos;9223372036854775808&apos; = 9223372036854775807 |</div><div class="line">+---------------------------------------------+</div><div class="line">|                                           1 |</div><div class="line">+---------------------------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;922337203&apos; = 922337203;</div><div class="line">+-------------------------+</div><div class="line">| &apos;922337203&apos; = 922337203 |</div><div class="line">+-------------------------+</div><div class="line">|                       1 |</div><div class="line">+-------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;922337203&apos; = 922337202;</div><div class="line">+-------------------------+</div><div class="line">| &apos;922337203&apos; = 922337202 |</div><div class="line">+-------------------------+</div><div class="line">|                       0 |</div><div class="line">+-------------------------+</div><div class="line">1 row in set (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select &apos;9223372036854775808&apos; + 0.0;</div><div class="line">+-----------------------------+</div><div class="line">| &apos;9223372036854775808&apos; + 0.0 |</div><div class="line">+-----------------------------+</div><div class="line">|        9.223372036854776e18 |</div><div class="line">+-----------------------------+</div><div class="line">1 row in set (0.00 sec)</div></pre></td></tr></table></figure></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-04-25T10:57:10.406Z" itemprop="dateUpdated">2017年4月25日 18:57</time>
</span><br>


        
    </div>
    <footer>
        <a href="https://shiqiupp.github.io">
            <img src="/img/avatar.jpg" alt="时秋">
            时秋
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/&title=《mysql隐式转换》 — 时秋的博客&pic=https://shiqiupp.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/&title=《mysql隐式转换》 — 时秋的博客&source=时秋的博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《mysql隐式转换》 — 时秋的博客&url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/&via=https://shiqiupp.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between flex-row-reverse">
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/04/10/java-fileread/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Java 文件读取</h4>
      </a>
    </div>
  
</nav>



    










</article>



</div>

        <footer class="footer">

    <div class="bottom">
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>时秋的博客 &copy; 2017</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/&title=《mysql隐式转换》 — 时秋的博客&pic=https://shiqiupp.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/&title=《mysql隐式转换》 — 时秋的博客&source=时秋的博客" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《mysql隐式转换》 — 时秋的博客&url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/&via=https://shiqiupp.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://shiqiupp.github.io/2017/04/25/mysql-implicit-conversions/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACtklEQVR42u3aMXLjQAwEQP//07qqi5yImgG4poJmpJIlapvBLjzAz098vf5fv1//vq7ff3e360++3lw/Jy48PDy80dKvbzd7ndzzGrC5Px4eHt5pXnIYXP9MsvVffzI5ivI14+Hh4X0DL4Ht7zx7THh4eHjfybv+/FMpAR4eHt5TvDw42Gzf7Rb/p1kLHh4eXsybNcCefX28v4eHh4c3KmpnB0Y7TJAfJPUK8fDw8A7w8kD2+h/+vP2f3y3Z7aMDAw8PD+9WXrKs/V/bOKMtrN9+Fw8PD+8Y70QgOyvN81I7etB4eHh4x3h3RQ/Jhr6PPIp/APDw8PAO8PLydxPdbg6VzTt4eHh4p3l3ta/auKGNj+twBA8PD+9WXh6VJg2zPIptH1PbJCsmxfDw8PBK3gazGSdtt/jZUAIeHh7eCV67+dYRarCU9v2kUfehpMbDw8Nb8NoQNh8myBe9Kc2j6AQPDw/vVl7ekt9v322jK4mDP8QWeHh4eH/C22zlbcmbD2wNQxM8PDy8Y7x7D4l7y+4k/ni7cjw8PLxjvGT7TpZV5B9lC62NSPDw8PBO89qIoS2vZ0MDs2jjhgQFDw8PL5iJyoef8gNgNv81BLQ3xcPDw7uJN2tBtcXxZgQh+WQd5uLh4eGNeO12n/9kfvC0MfEsgMbDw8O7lzcroJNIYn/PWaCMh4eHd443azvlS8wPldkIAh4eHt6zvJaal9SrIYDNhYeHh3cr71Ve7QPKW2uzNtuHgh4PDw/vAG92eMxGAdr2WD5GMExf8PDw8Ba8ttHVRrSbAYK2AVYX1nh4eHgLXlso5+MCmwB337rDw8PD+wbe7BHk7LZY//BdPDw8vEd5eZibb/f7YwYPDw/vKV6+Zc8297a5lTfGVgMEeHh4eIvu+SxyvWtgKx8RODKkhYeHh5fy/gHtmLtgOf0aOAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };



</script>

<script src="//unpkg.com/hexo-theme-material-indigo@1.5.0/source/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@1.5.0/source/js/search.min.js" async></script>








<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '';
            clearTimeout(titleTime);
        } else {
            document.title = '';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
